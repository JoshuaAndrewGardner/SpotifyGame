<!DOCTYPE html>
<html>
    <head>
        <title>Spotify Web Playback SDK Quick Start Tutorial</title>
    </head>
    <body>
        <h1>Spotify Web Playback SDK Quick Start Tutorial</h1>
        <h2>Open your console log: <code>View > Developer > JavaScript Console</code></h2>

        <script src="https://sdk.scdn.co/spotify-player.js"></script>
        <script>
            // Called when the Spotify Web Playback SDK is ready to use
            window.onSpotifyWebPlaybackSDKReady = () => {

                // Define the Spotify Connect device, getOAuthToken has an actual token 
                // hardcoded for the sake of simplicity
                var player = new Spotify.Player({
                    name: 'A Spotify Web SDK Player',
                    getOAuthToken: callback => {
                        callback('BQBQvlPnBCHtT7Ysdf8wyEJwtqoqM8dqgRTYOpLvnI3PRTU9iJbKEFnXGPUhZiyZzSugIYL5kHukNLRAhcu0mqQYdnR5Mq-AAa4iQ67RVZxnrPxwAtC0cSQvsbrllYFIwTT-llxzmhUX6yq-r5QRC3iDudEuNLR0GAo');
                    },
                    volume: 0.1
                });

                // Called when connected to the player created beforehand successfully
                player.addListener('ready', ({ device_id }) => {
                    console.log('Ready with Device ID', device_id);

                    const play = ({
                        spotify_uri,
                        playerInstance: {
                            _options: {
                                getOAuthToken,
                                id
                            }
                        }
                    }) => {
                        getOAuthToken(access_token => {
                            fetch(`https://api.spotify.com/v1/me/player/play?device_id=${id}`, {
                                method: 'PUT',
                                body: JSON.stringify({ uris: [spotify_uri] }),
                                headers: {
                                    'Content-Type': 'application/json',
                                    'Authorization': `Bearer ${access_token}`
                                },
                            });
                        });
                    };

                    play({
                        playerInstance: player,
                        spotify_uri: 'spotify:track:7xGfFoTpQ2E7fRF5lN10tr',
                    });
                });

                // Connect to the player created beforehand, this is equivalent to 
                // creating a new device which will be visible for Spotify Connect
                player.connect();
            };

        </script>
        <button onclick="activate()">Hellothere</button>
    </body>
</html>